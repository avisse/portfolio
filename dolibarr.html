<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>POC ERP Dolibarr ‚Äì Collectivit√©</title>
  <meta name="description" content="Preuve de faisabilit√© (POC) Dolibarr en Docker pour une collectivit√© : d√©ploiement, param√©trage, sc√©narios Finance et RH."/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0f1220;
      --panel:#151935;
      --muted:#99a2c2;
      --text:#e7ecff;
      --accent:#6ee7b7;
      --accent-2:#60a5fa;
      --border:rgba(255,255,255,.08);
      --code:#0b0e1d;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;
      color:var(--text);
      background:
        radial-gradient(80rem 50rem at -20% -10%, #1a1f46 0%, transparent 60%),
        radial-gradient(60rem 40rem at 120% -10%, #17324f 0%, transparent 60%),
        var(--bg);
      line-height:1.55;
    }
    .container{max-width:1100px;margin:0 auto;padding:32px}
    header.hero{
      padding:72px 0 40px;
      text-align:center;
    }
    .badge{
      display:inline-block;
      font-size:.8rem;
      padding:.3rem .6rem;
      border:1px solid var(--border);
      color:var(--muted);
      border-radius:999px;
      margin-bottom:10px;
      background:rgba(255,255,255,.03);
    }
    h1{
      font-size:clamp(1.8rem,3.2vw,2.6rem);
      margin:.2rem 0 0.6rem;
      letter-spacing:.2px;
    }
    .subtitle{color:var(--muted);max-width:850px;margin:0 auto 20px}
    .grid{
      display:grid;
      gap:18px;
      grid-template-columns:repeat(12,1fr);
    }
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid var(--border);
      border-radius:16px;
      padding:18px 20px;
      backdrop-filter:saturate(140%) blur(8px);
      box-shadow:0 10px 30px rgba(0,0,0,.25);
    }
    .card h3{margin:.2rem 0 .6rem}
    .muted{color:var(--muted)}
    .kpi{display:flex;gap:16px;flex-wrap:wrap;margin:20px 0}
    .kpi .pill{
      border:1px solid var(--border);
      border-radius:12px;
      padding:10px 14px;
      background:rgba(255,255,255,.03);
      font-weight:600;
    }
    .toc{
      display:flex;gap:10px;flex-wrap:wrap;margin-top:10px
    }
    .toc a{
      color:var(--accent-2);text-decoration:none;border:1px solid var(--border);
      padding:8px 12px;border-radius:10px;background:rgba(96,165,250,.08)
    }
    section{margin:36px 0}
    h2{margin:0 0 12px;font-size:1.5rem}
    h4{margin:18px 0 6px}
    code,pre{
      font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
      font-size:.95rem;
    }
    pre{
      background:var(--code);
      border:1px solid var(--border);
      border-radius:12px;
      padding:14px 14px;
      overflow:auto;
      position:relative;
      margin:12px 0 18px;
    }
    .copy{
      position:absolute;right:10px;top:10px;
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border:1px solid var(--border);color:var(--text);
      padding:6px 10px;border-radius:8px;cursor:pointer;font-size:.8rem
    }
    .callout{
      border-left:4px solid var(--accent);
      background:rgba(110,231,183,.08);
      padding:12px 14px;border-radius:10px;margin:12px 0;color:#d0ffe9
    }
    .gallery{
      display:grid;gap:14px;
      grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
    }
    .fig{
      background:rgba(255,255,255,.03);
      border:1px solid var(--border);
      border-radius:12px;overflow:hidden
    }
    .fig img{width:100%;display:block}
    .fig figcaption{
      padding:8px 10px;font-size:.9rem;color:var(--muted);border-top:1px solid var(--border)
    }
    footer{
      margin:50px 0 10px;text-align:center;color:var(--muted);font-size:.9rem
    }
    .tag{display:inline-block;padding:.25rem .5rem;border-radius:8px;border:1px solid var(--border);margin-right:6px;color:var(--muted)}
    .list{padding-left:18px;margin:8px 0}
    .hl{color:var(--accent)}
    .twocol{display:grid;gap:16px;grid-template-columns:1fr; }
    @media(min-width:920px){ .twocol{grid-template-columns:1fr 1fr;} }
  </style>
</head>
<body>
  <div class="container">
    <header class="hero">
      <span class="badge">POC Collectivit√© ‚Ä¢ ERP Open Source</span>
      <h1>Dolibarr en Docker ‚Äì Preuve de faisabilit√© (A ‚Üí Z)</h1>
      <p class="subtitle">D√©ploiement reproductible, param√©trage en fran√ßais, d√©monstrations m√©tiers <b>Finance</b> (factures client/fournisseur) et <b>RH</b> (cong√© agent) ‚Äî le tout dans un dossier versionn√©.</p>
      <div class="kpi">
        <span class="pill">‚è±Ô∏è Mise en place rapide</span>
        <span class="pill">üíæ Donn√©es persistantes</span>
        <span class="pill">üß© Modules activables</span>
        <span class="pill">üîê Permissions RH</span>
      </div>
      <div class="toc">
        <a href="#resume">R√©sum√©</a>
        <a href="#archi">Architecture</a>
        <a href="#setup">Mise en place</a>
        <a href="#param">Param√©trage</a>
        <a href="#donnees">Catalogue & Tiers</a>
        <a href="#scenario1">Sc√©nario Finance</a>
        <a href="#scenario2">Sc√©nario RH</a>
        <a href="#captures">Captures</a>
        <a href="#ops">Exploitation</a>
      </div>
    </header>

    <!-- R√©sum√© -->
    <section id="resume" class="card">
      <h2>0) R√©sum√© ex√©cutif</h2>
      <p><b>Faisabilit√© :</b> d√©ploiement d‚Äôun ERP open-source (<span class="hl">Dolibarr</span>) en &lt; 1h sur Debian 12 via Docker Compose, avec persistance. </p>
      <ul class="list">
        <li><b>Finance :</b> 1 produit + 1 service, <i>1 client</i>, <i>1 fournisseur</i>, <i>1 facture client (150 ‚Ç¨ HT)</i>, <i>1 facture fournisseur (100 ‚Ç¨ HT)</i>.</li>
        <li><b>RH :</b> cr√©ation d‚Äôun agent, permissions Cong√©s, demande (RTT 1 jour) valid√©e par l‚Äôadmin.</li>
      </ul>
      <p><b>Valeur Collectivit√© :</b> solution gratuite, francis√©e, modulaire, simple √† administrer, tra√ßable, extensible (mails, PDF, reporting, SSO) pour un pilote 30‚Äì50 comptes.</p>
    </section>

    <!-- Architecture -->
    <section id="archi" class="card">
      <h2>1) Contexte & choix d‚Äôarchitecture</h2>
      <div class="twocol">
        <div>
          <p><b>Pourquoi Dolibarr ?</b> l√©ger, modulaire, communaut√© FR, ergonomie simple. <b>ERPNext</b> est excellent mais plus lourd (Frappe/Redis/Workers) : pas optimal pour un POC express.</p>
          <p class="muted"><span class="tag">OS: Debian 12</span> <span class="tag">Containers: mariadb:10.11 + tuxgasy/dolibarr</span> <span class="tag">Port: 8087</span> <span class="tag">Langue: FR</span></p>
        </div>
        <div>
<pre><button class="copy" data-for="tree">Copier</button><code id="tree">projet-ecf/
‚îî‚îÄ dolibarr/
   ‚îú‚îÄ .env
   ‚îú‚îÄ docker-compose.yml
   ‚îî‚îÄ volumes/
      ‚îú‚îÄ mariadb/      # donn√©es SQL persistantes
      ‚îî‚îÄ dolibarr/     # documents/PDF</code></pre>
        </div>
      </div>
    </section>

    <!-- Mise en place -->
    <section id="setup" class="card">
      <h2>2) Mise en place (pas √† pas)</h2>
      <h4>2.1 Pr√©-requis OS</h4>
<pre><button class="copy" data-for="os">Copier</button><code id="os">sudo apt update
sudo apt install -y docker.io docker-compose-plugin
sudo usermod -aG docker $USER   # puis d√©connexion/reconnexion</code></pre>

      <h4>2.2 Projet & volumes</h4>
<pre><button class="copy" data-for="mk">Copier</button><code id="mk">mkdir -p ~/projet-ecf/dolibarr/{volumes/dolibarr,volumes/mariadb}
cd ~/projet-ecf/dolibarr</code></pre>

      <h4>2.3 Fichier <code>.env</code></h4>
<pre><button class="copy" data-for="env">Copier</button><code id="env">MYSQL_ROOT_PASSWORD=changeme-root
MYSQL_DATABASE=dolibarr
MYSQL_USER=dolibarr
MYSQL_PASSWORD=changeme
DOLI_HTTP_PORT=8087</code></pre>

      <h4>2.4 <code>docker-compose.yml</code></h4>
<pre><button class="copy" data-for="compose">Copier</button><code id="compose">services:
  db:
    image: mariadb:10.11
    restart: unless-stopped
    environment:
      MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD}
      MYSQL_DATABASE: ${MYSQL_DATABASE}
      MYSQL_USER: ${MYSQL_USER}
      MYSQL_PASSWORD: ${MYSQL_PASSWORD}
    volumes:
      - ./volumes/mariadb:/var/lib/mysql
    healthcheck:
      test: ["CMD", "mysqladmin", "ping", "-h", "localhost"]
      interval: 10s
      timeout: 5s
      retries: 10

  dolibarr:
    image: tuxgasy/dolibarr:latest
    restart: unless-stopped
    depends_on:
      db:
        condition: service_healthy
    environment:
      DOLI_DB_HOST: db
      DOLI_DB_NAME: ${MYSQL_DATABASE}
      DOLI_DB_USER: ${MYSQL_USER}
      DOLI_DB_PASSWORD: ${MYSQL_PASSWORD}
    ports:
      - "${DOLI_HTTP_PORT}:80"
    volumes:
      - ./volumes/dolibarr:/var/www/html/documents</code></pre>

      <h4>2.5 D√©marrage & contr√¥le</h4>
<pre><button class="copy" data-for="run">Copier</button><code id="run">docker compose up -d
docker compose ps
# Acc√®s: http://localhost:8087
ss -ltnp | grep 8087 || echo "8087 libre"</code></pre>

      <div class="callout">
        Assistant Dolibarr ‚Üí Base <b>db</b>, BDD <b>dolibarr</b>, user <b>dolibarr</b> / pass <b>changeme</b>.  
        Puis cr√©er le compte administrateur.  
        <b>Configuration ‚Üí Affichage ‚Üí Fran√ßais</b>.
      </div>
    </section>

    <!-- Param√©trage -->
    <section id="param" class="card">
      <h2>3) Param√©trage initial</h2>
      <h4>3.1 Soci√©t√©</h4>
      <p><b>Configuration ‚Üí Soci√©t√©/Organisation</b> : <i>VilleDemo</i>, France, adresse. Enregistrer.</p>
      <h4>3.2 Modules</h4>
      <ul class="list">
        <li><b>Utilisateurs & Groupes</b></li>
        <li><b>Tiers</b> (clients/fournisseurs)</li>
        <li><b>Produits</b> & <b>Services</b></li>
        <li><b>Facturation</b> (clients & fournisseurs)</li>
        <li><b>Cong√©s/Absences</b> (RH)</li>
      </ul>
    </section>

    <!-- Donn√©es -->
    <section id="donnees" class="card">
      <h2>4) Donn√©es de d√©monstration</h2>
      <div class="twocol">
        <div>
          <h4>Catalogue</h4>
          <ul class="list">
            <li><b>Service</b> : <i>Formation bureautique</i> ‚Äî 150,00 ‚Ç¨ HT ‚Äî TVA 20 % ‚Äî En vente: Oui</li>
            <li><b>Produit</b> : <i>Ramettes papier A4</i> ‚Äî 100,00 ‚Ç¨ HT ‚Äî TVA 20 % ‚Äî En vente: Oui</li>
          </ul>
        </div>
        <div>
          <h4>Tiers</h4>
          <ul class="list">
            <li><b>Client</b> : Association Quartier Nord</li>
            <li><b>Fournisseur</b> : Papeterie Sud</li>
          </ul>
        </div>
      </div>
      <p class="muted">On cr√©e d‚Äôabord le catalogue ‚Üí ensuite on s√©lectionne ces √©l√©ments dans les documents (devis, factures‚Ä¶).</p>
    </section>

    <!-- Sc√©nario Finance -->
    <section id="scenario1" class="card">
      <h2>5) Sc√©nario #1 ‚Äî Finance (factures)</h2>
      <div class="twocol">
        <div>
          <h4>5.1 Facture client</h4>
          <ol class="list">
            <li>Facturation ‚Üí <b>Factures clients ‚Üí Nouvelle facture</b></li>
            <li>Client : <i>Association Quartier Nord</i> ; Type : <i>standard</i></li>
            <li>Ajouter ligne ‚Üí <b>Service</b> <i>Formation bureautique</i> (150 ‚Ç¨ HT)</li>
            <li><b>Valider</b> la facture (HT 150 / TVA 30 / TTC 180)</li>
            <li>(Option) <b>R√®glement</b> : encaissement carte ‚Üí statut Pay√©e</li>
          </ol>
        </div>
        <div>
          <h4>5.2 Facture fournisseur</h4>
          <ol class="list">
            <li>Facturation ‚Üí <b>Factures fournisseur ‚Üí Nouvelle facture</b></li>
            <li>Fournisseur : <i>Papeterie Sud</i> ; Type : <i>standard</i></li>
            <li>Ajouter ligne ‚Üí <b>Produit</b> <i>Ramettes papier A4</i> (100 ‚Ç¨ HT)</li>
            <li><b>Valider</b> (HT 100 / TVA 20 / TTC 120)</li>
          </ol>
        </div>
      </div>
      <p class="muted">On d√©montre le cycle achat/vente, la tra√ßabilit√© et la g√©n√©ration documentaire (PDF).</p>
    </section>

    <!-- Sc√©nario RH -->
    <section id="scenario2" class="card">
      <h2>6) Sc√©nario #2 ‚Äî RH (cong√©s)</h2>
      <div class="twocol">
        <div>
          <h4>6.1 Employ√© & permissions</h4>
          <ol class="list">
            <li>Utilisateurs & Groupes ‚Üí <b>Nouvel utilisateur</b> : <i>Alice Martin</i> (`amartin`) ‚Äî <b>Salari√©: Oui</b></li>
            <li>Onglet <b>Permissions</b> ‚Üí Cong√©s :  
              <ul class="list">
                <li>‚úÖ Lire vos demandes</li>
                <li>‚úÖ Cr√©er/modifier vos demandes</li>
              </ul>
            </li>
          </ol>
        </div>
        <div>
          <h4>6.2 Demande & validation</h4>
          <ol class="list">
            <li>Connexion Alice ‚Üí GRH ‚Üí <b>Nouvelle demande</b> (RTT, 1 jour)</li>
            <li>Connexion SuperAdmin ‚Üí <b>Approuver/Valider</b> la demande</li>
            <li>Statut final : <b>Approuv√©e</b> (historique : demand√© par Alice / approuv√© par SuperAdmin)</li>
          </ol>
        </div>
      </div>
      <p class="muted">On d√©montre un workflow RH simple : employ√© ‚Üí manager/admin, avec journalisation.</p>
    </section>

    <!-- Captures -->
    <section id="captures" class="card">
      <h2>7) Captures du POC</h2>
      <p class="muted">Place tes images dans <code>docs/captures/</code>. Noms de fichiers recommand√©s (sans espaces ni accents) :</p>
      <ul class="list">
        <li>dolibarr_login.png ‚Ä¢ parametrage_modules.png ‚Ä¢ creation_client.png ‚Ä¢ facture_client.png ‚Ä¢ validation_facture.png ‚Ä¢ reglement_facture.png</li>
        <li>creation_service.png ‚Ä¢ compte_alice.png ‚Ä¢ parametrage_conges.png ‚Ä¢ creation_conge.png ‚Ä¢ conge_approuve.png</li>
      </ul>

      <div class="gallery">
        <!-- Remplace les src ci-dessous par tes vrais chemins si besoin -->
        <figure class="fig">
          <img src="docs/captures/dolibarr_login.png" alt="√âcran de login Dolibarr">
          <figcaption>Accueil / Login Dolibarr</figcaption>
        </figure>
        <figure class="fig">
          <img src="docs/captures/parametrage_modules.png" alt="Param√©trage des modules">
          <figcaption>Activation des modules essentiels</figcaption>
        </figure>
        <figure class="fig">
          <img src="docs/captures/creation_service.png" alt="Cr√©ation d'un service">
          <figcaption>Catalogue : service ‚ÄúFormation bureautique‚Äù</figcaption>
        </figure>
        <figure class="fig">
          <img src="docs/captures/creation_client.png" alt="Cr√©ation client">
          <figcaption>Cr√©ation du client ‚ÄúAssociation Quartier Nord‚Äù</figcaption>
        </figure>
        <figure class="fig">
          <img src="docs/captures/facture_client.png" alt="Facture client">
          <figcaption>Facture client (150 ‚Ç¨ HT)</figcaption>
        </figure>
        <figure class="fig">
          <img src="docs/captures/validation_facture.png" alt="Validation facture">
          <figcaption>Validation de la facture client</figcaption>
        </figure>
        <figure class="fig">
          <img src="docs/captures/compte_alice.png" alt="Compte employ√©">
          <figcaption>Fiche employ√©e : Alice Martin</figcaption>
        </figure>
        <figure class="fig">
          <img src="docs/captures/parametrage_conges.png" alt="Param√©trage cong√©s">
          <figcaption>Permissions cong√©s (Alice)</figcaption>
        </figure>
        <figure class="fig">
          <img src="docs/captures/creation_conge.png" alt="Cr√©ation d'une demande de cong√©">
          <figcaption>Demande de cong√© (Alice)</figcaption>
        </figure>
        <figure class="fig">
          <img src="docs/captures/conge_approuve.png" alt="Cong√© approuv√©">
          <figcaption>Validation du cong√© (statut Approuv√©e)</figcaption>
        </figure>
      </div>
    </section>

    <!-- Exploitation -->
    <section id="ops" class="card">
      <h2>8) Exploitation & bonnes pratiques</h2>
      <div class="twocol">
        <div>
          <h4>Commandes utiles</h4>
<pre><button class="copy" data-for="ops1">Copier</button><code id="ops1"># d√©marrer / arr√™ter
docker compose up -d
docker compose down

# logs
docker compose logs -f --tail=100 db
docker compose logs -f --tail=100 dolibarr

# sauvegarde volumes
tar -czf backup-dolibarr-$(date +%F).tgz volumes/</code></pre>
        </div>
        <div>
          <h4>Reset mot de passe admin (si besoin)</h4>
<pre><button class="copy" data-for="ops2">Copier</button><code id="ops2">DB_ID=$(docker ps -qf "name=_db_")
docker exec -it "$DB_ID" mysql -u dolibarr -pchangeme dolibarr -e "
UPDATE llx_user
SET login='admin', pass_crypted=MD5('admin123')
WHERE login='admin' OR rowid=1;
SELECT rowid, login FROM llx_user;"</code></pre>
        </div>
      </div>
      <p class="muted">S√©curit√© : secrets plus robustes, reverse-proxy + HTTPS, sauvegardes r√©guli√®res (mysqldump + documents), r√¥les/permissions, mises √† jour d‚Äôimages.</p>
    </section>

    <footer>
      <p>POC Dolibarr ‚Ä¢ Collectivit√© ‚Äî r√©alis√© avec Docker ‚Ä¢ <span class="hl">Finance</span> & <span class="hl">RH</span> sc√©naris√©s.</p>
    </footer>
  </div>

  <script>
    document.querySelectorAll('.copy').forEach(btn=>{
      btn.addEventListener('click',()=>{
        const id = btn.getAttribute('data-for');
        const el = document.getElementById(id);
        navigator.clipboard.writeText(el.textContent).then(()=>{
          const old = btn.textContent;
          btn.textContent = 'Copi√© ‚úì';
          setTimeout(()=>btn.textContent=old,1200);
        });
      });
    });
  </script>
</body>
</html>
