<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <title>Spring Boot → Docker → Kubernetes (Minikube) + Angular</title>

  <!-- Favicons -->
  <link href="./assets/img/favicon.png" rel="icon" />
  <link href="./assets/img/apple-touch-icon.png" rel="apple-touch-icon" />

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700|Poppins:300,400,500,600,700" rel="stylesheet" />

  <!-- Vendor CSS (minimal, indépendant du template principal) -->
  <link href="./assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
  <link href="./assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet" />
  <link href="./assets/vendor/owl.carousel/assets/owl.carousel.min.css" rel="stylesheet" />

  <style>
    :root { --brand:#0a66ff; --ink:#1b2a4e; --muted:#6b7a90; }
    body{ font-family: "Open Sans", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background:#fff; color:#243047; }
    h2,h3,h4,h5{ font-family: "Poppins", sans-serif; }

    /* Header titre */
    .portfolio-title{ text-align:center; color:var(--brand); font-weight:700; margin:6px 0 18px; }

    /* Carrousel */
    .portfolio-details-carousel img{
      width:100%; height:auto; border-radius:12px; box-shadow:0 14px 28px rgba(0,0,0,.08);
    }

    /* Carte latérale */
    .aside-card{
      background:#fff; border:1px solid #e9eef5; border-radius:14px; padding:18px 18px 16px;
      box-shadow:0 8px 22px rgba(2,21,78,.06);
    }
    .kicker{ color:var(--muted); }

    /* Chips */
    .chip{
      display:inline-block; padding:.22rem .58rem; margin:0 .28rem .38rem 0;
      border-radius:999px; border:1px solid rgba(10,102,255,.18);
      background:rgba(10,102,255,.07); color:var(--ink); font-size:.78rem; font-weight:600;
    }

    /* Bouton GitHub */
    .btn-repo{
      display:inline-flex; align-items:center; gap:.45rem; font-weight:700;
      background:var(--brand); color:#fff !important; border:none; border-radius:10px;
      padding:.55rem .9rem; box-shadow:0 10px 18px rgba(10,102,255,.22);
      text-decoration:none;
    }
    .btn-repo:hover{ filter:brightness(1.05); transform:translateY(-1px); transition:.12s; }

    /* Accordéons */
    .faq-item{ border-bottom:1px solid #edf2f7; }
    .question{
      cursor:pointer; padding:16px 6px; font-weight:700; color:#1f2a44; position:relative;
      display:flex; align-items:center; justify-content:space-between;
    }
    .question .arrow{ color:var(--brand); }
    .answer{ max-height:0; overflow:hidden; transition:max-height .3s ease; }
    .answer-visible{ max-height:3000px; }

    /* Codes lisibles */
    pre,code{ background:#0f172a; color:#e5e7eb; border-radius:10px; }
    pre{ padding:14px 16px; overflow:auto; }
    code{ padding:2px 6px; }

    /* Petites touches */
    ul{ margin-bottom:0; }
    .soft{ color:#8aa0b6; }
  </style>
</head>

<body>
<main id="main">
  <section id="portfolio-details" class="portfolio-details">
    <div class="container">

      <div class="row">
        <!-- Carrousel -->
        <div class="col-lg-8">
          <h2 class="portfolio-title">Automatisation Spring Boot → Docker → Kubernetes (Minikube) + Angular</h2>

          <div class="owl-carousel portfolio-details-carousel">
            <!-- Garde EXACTEMENT ces images -->
            <img src="./assets/img/start.spring.jpg" class="img-fluid" alt="Spring Initializr">
            <img src="./assets/img/sucess hello world Spring Boot.jpg" class="img-fluid" alt="Hello World Spring Boot">
            <img src="./assets/img/resultat-build-projet-infoline.jpg" class="img-fluid" alt="Build/Logs backend">
            <img src="./assets/img/helloangular.png" class="img-fluid" alt="Angular en local">
            <img src="./assets/img/creation hello angular.jpg" class="img-fluid" alt="Création Angular CLI">
            <img src="./assets/img/activité 5- tentative-execution-locale-circleci.jpg" class="img-fluid" alt="CircleCI local">
          </div>
        </div>

        <!-- Résumé + tags -->
        <div class="col-lg-4">
          <div>
            
          </div>
          <div class="aside-card">
            <h5 style="font-weight:700;">E2E local : Java → Docker → K8s + Angular & CI locale</h5>
            <p class="kicker">
              Projet de bout en bout: développement d’une API <b>Spring Boot</b>, packaging en <b>Docker</b>,
              déploiement sur <b>Minikube</b> via <b>YAML</b>, et validation front avec un <b>Hello Angular</b>.
              Un job <b>CircleCI</b> est aussi exécuté en local pour illustrer la CI.  
              <i>Fil rouge : montrer une chaîne Dev → Ops reproductible, entièrement en local (zéro coût cloud).</i>
            </p>

            <div class="mb-2">
              <span class="chip">Java 17</span><span class="chip">Spring Boot 3</span><span class="chip">Maven</span>
              <span class="chip">Docker</span><span class="chip">Kubernetes</span><span class="chip">Minikube</span>
              <span class="chip">YAML</span><span class="chip">Angular</span><span class="chip">Node 20</span>
              <span class="chip">CircleCI (local)</span>
            </div>

            <p class="mb-1"><b>Catégorie :</b> Dev / DevOps</p>
            <p class="mb-1"><b>Contexte :</b> VM Debian (VirtualBox), tout en local.</p>
            <p class="mb-3"><b>Livrables :</b> code Java, <code>Dockerfile</code>, <code>deployment.yaml</code>, <code>service.yaml</code>, projet Angular, <code>.circleci/config.yml</code>.</p>

            <a class="btn-repo" href="https://github.com/avisse/activite-2" target="_blank" rel="noopener">
              <i class="bx bxl-github"></i> Voir le repository GitHub
            </a>
          </div>
        </div>
      </div>

      <!-- ======= Accordéons détaillés ======= -->
      <div class="row mt-4">
        <div class="col-lg-12">

          <!-- 1. Contexte & objectifs -->
          <div class="faq-item">
            <div class="question" onclick="toggleAnswer('a0', this)">
              <span>1) Contexte & objectifs </span>
              <span class="arrow"><i class="bx bx-chevron-down"></i></span>
            </div>
            <div class="answer" id="a0">
              <div class="p-2">
                <ul>
                  <li><b>Objectif pédagogique :</b> prouver que je sais <b>développer</b>, <b>packager</b>, <b>déployer</b> et <b>opérer</b> une app Java.</li>
                  <li><b>Contraintes :</b> tout faire <b>en local</b> (pas de cloud payant), <b>reproductible</b> (commandes/script), et <b>clairement documenté</b>.</li>
                </ul>
                <p class="soft mb-2">Ce choix “full local” m’a obligé à gérer : versions de Java/Node, droits Docker, RAM Minikube, et la CLI CircleCI.</p>
              </div>
            </div>
          </div>

          <!-- 2. Architecture & choix -->
          <div class="faq-item">
            <div class="question" onclick="toggleAnswer('a1', this)">
              <span>2) Architecture & choix techniques</span>
              <span class="arrow"><i class="bx bx-chevron-down"></i></span>
            </div>
            <div class="answer" id="a1">
              <div class="p-2">
                <ul>
                  <li><b>Back</b> : Spring Boot (endpoint “Hello World”).</li>
                  <li><b>Packaging</b> : Docker (multi-stage → image finale légère).</li>
                  <li><b>Orchestration</b> : Kubernetes avec <b>Minikube</b> (Deployment + Service NodePort).</li>
                  <li><b>Front</b> : Angular (Hello Angular) pour valider l’environnement UI.</li>
                  <li><b>CI</b> : job CircleCI exécuté en local pour builder l’app Angular.</li>
                </ul>

<pre><code>helloworld/
├── src/main/java/com/infoline/helloworld/
│   ├── HelloworldApplication.java
│   └── HelloController.java
├── Dockerfile
├── pom.xml
├── deployment.yaml
└── service.yaml
</code></pre>
              </div>
            </div>
          </div>

          <!-- 3. Implémentation pas à pas -->
          <div class="faq-item">
            <div class="question" onclick="toggleAnswer('a2', this)">
              <span>3) Implémentation — du code à Kubernetes (pas à pas)</span>
              <span class="arrow"><i class="bx bx-chevron-down"></i></span>
            </div>
            <div class="answer" id="a2">
              <div class="p-2">

                <p class="mb-1"><b>3.1 Code Spring Boot (extrait)</b></p>
<pre><code class="language-java">@RestController
public class HelloController {
  @GetMapping("/hello")
  public String hello() { return "Hello, World!"; }
}</code></pre>

                <p class="mb-1"><b>3.2 Build Maven</b> — je compile et j’empaquette :</p>
<pre><code class="language-bash">mvn clean package -DskipTests</code></pre>

                <p class="mb-1"><b>3.3 Image Docker multi-stage</b> — première étape <i>build</i>, deuxième étape <i>runtime</i> :</p>
<pre><code class="language-docker"># Étape 1 : build Maven
FROM maven:3.9.6-eclipse-temurin-17 AS build
WORKDIR /app
COPY . .
RUN mvn clean package -DskipTests

# Étape 2 : image exécutable
FROM eclipse-temurin:17-jdk
WORKDIR /app
COPY --from=build /app/target/*.jar app.jar
EXPOSE 8080
ENTRYPOINT ["java", "-jar", "app.jar"]</code></pre>

<pre><code class="language-bash">docker build -t helloworld-app .
docker run -p 8080:8080 helloworld-app
# Test : http://localhost:8080/hello</code></pre>

                <p class="mb-1"><b>3.4 Minikube</b> — démarrage + chargement de l’image locale :</p>
<pre><code class="language-bash">minikube start --memory=4096mb
minikube image load helloworld-app</code></pre>

                <p class="mb-1"><b>3.5 Manifests Kubernetes</b> — <code>Deployment</code> & <code>Service</code> :</p>
<pre><code class="language-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: helloworld-deployment
spec:
  replicas: 1
  selector:
    matchLabels:
      app: helloworld
  template:
    metadata:
      labels:
        app: helloworld
    spec:
      containers:
      - name: helloworld
        image: helloworld-app
        imagePullPolicy: Never  # on utilise l'image déjà chargée dans Minikube
        ports:
        - containerPort: 8080</code></pre>

<pre><code class="language-yaml">apiVersion: v1
kind: Service
metadata:
  name: helloworld-service
spec:
  type: NodePort
  selector:
    app: helloworld
  ports:
    - protocol: TCP
      port: 8080
      targetPort: 8080
      nodePort: 30080</code></pre>

<pre><code class="language-bash">kubectl apply -f deployment.yaml
kubectl apply -f service.yaml

# Récupérer l'URL exposée
minikube service helloworld-service --url
# Exemple : http://192.168.49.2:30080</code></pre>
              </div>
            </div>
          </div>

          <!-- 4. Script d'automatisation -->
          <div class="faq-item">
            <div class="question" onclick="toggleAnswer('a3', this)">
              <span>4) Script d’automatisation — Build → Image → K8s</span>
              <span class="arrow"><i class="bx bx-chevron-down"></i></span>
            </div>
            <div class="answer" id="a3">
              <div class="p-2">
<pre><code class="language-bash">#!/usr/bin/env bash
set -e

echo "### Build Maven"
mvn clean package -DskipTests

echo "### Build Docker"
docker build -t helloworld-app .

echo "### Minikube start + load image"
minikube start --memory=4096mb
minikube image load helloworld-app

echo "### Apply manifests"
kubectl apply -f deployment.yaml
kubectl apply -f service.yaml

echo "### Wait pod ready"
kubectl wait --for=condition=ready pod -l app=helloworld --timeout=120s

URL=$(minikube service helloworld-service --url)
echo "App OK -> $URL"
curl -s $URL</code></pre>
                <p class="soft">Ce script me permet de rejouer la chaîne complète en une commande.</p>
              </div>
            </div>
          </div>

          <!-- 5. Angular -->
          <div class="faq-item">
            <div class="question" onclick="toggleAnswer('a4', this)">
              <span>5) Hello Angular — validation de l’environnement Front</span>
              <span class="arrow"><i class="bx bx-chevron-down"></i></span>
            </div>
            <div class="answer" id="a4">
              <div class="p-2">
<pre><code class="language-bash"># Prérequis : Node 20+
npx @angular/cli@latest new hello-angular
cd hello-angular
npm start
# http://localhost:4200</code></pre>
                <p>But : s’assurer que mon environnement Front est viable (CLI, dépendances, serveurs) et
                   montrer que je peux aussi “toucher” à la couche UI.</p>
              </div>
            </div>
          </div>

          <!-- 6. CI locale -->
          <div class="faq-item">
            <div class="question" onclick="toggleAnswer('a5', this)">
              <span>6) CI locale (CircleCI) — exécution d’un job en local</span>
              <span class="arrow"><i class="bx bx-chevron-down"></i></span>
            </div>
            <div class="answer" id="a5">
              <div class="p-2">
                <p><b>.circleci/config.yml</b> (extrait) :</p>
<pre><code class="language-yaml">version: 2.1
jobs:
  build-and-test:
    docker:
      - image: cimg/node:20.19.1
    steps:
      - checkout
      - run: npm ci
      - run: npm run build
      - run: echo "Bonjour studi — Steve Avisse"
workflows:
  build:
    jobs:
      - build-and-test</code></pre>

<pre><code class="language-bash"># Lancer le job en local (nouvelle CLI, sans --job)
circleci local execute build-and-test</code></pre>

                <p class="mb-0"><b>Points clés résolus :</b></p>
                <ul>
                  <li>Version Node insuffisante → <code>cimg/node:20.19.1</code>.</li>
                  <li>Espace disque VM limité → extension du VDI + GParted.</li>
                  <li>Option CLI obsolète → syntaxe <code>circleci local execute build-and-test</code>.</li>
                </ul>
              </div>
            </div>
          </div>

          <!-- 7. Nettoyage & REX -->
          <div class="faq-item">
            <div class="question" onclick="toggleAnswer('a6', this)">
              <span>7) Nettoyage & Retour d’expérience (REX)</span>
              <span class="arrow"><i class="bx bx-chevron-down"></i></span>
            </div>
            <div class="answer" id="a6">
              <div class="p-2">
                <p><b>Nettoyage :</b></p>
<pre><code class="language-bash">kubectl delete -f service.yaml
kubectl delete -f deployment.yaml
minikube stop
minikube delete</code></pre>
                <ul>
                  <li><b>Résultat :</b> image Docker fonctionnelle, pods stables, service exposé, Angular opérationnel, CI locale OK.</li>
                  <li><b>REX :</b> toujours vérifier <code>JAVA_HOME</code>, les droits Docker (sudo/groupe), et la cohérence des versions (Node/Angular).</li>
                </ul>
              </div>
            </div>
          </div>

        </div><!-- /col -->
      </div><!-- /row -->

    </div><!-- /container -->
  </section>
</main>

<!-- Back to top (optionnel si ton template l’affiche déjà) -->
<a href="#" class="back-to-top" style="position:fixed;right:16px;bottom:16px;display:inline-flex;align-items:center;justify-content:center;width:40px;height:40px;border-radius:50%;background:#0a66ff;color:#fff;text-decoration:none;"><i class="bx bx-up-arrow-alt"></i></a>

<!-- Vendor JS (autonome, pas de main.js du template) -->
<script src="./assets/vendor/jquery/jquery.min.js"></script>
<script src="./assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="./assets/vendor/owl.carousel/owl.carousel.min.js"></script>

<script>
  // Carrousel autonome
  $(function(){
    $('.portfolio-details-carousel').owlCarousel({
      items: 1,
      loop: true,
      autoplay: true,
      autoplayTimeout: 3500,
      smartSpeed: 600,
      dots: true,
      margin: 10
    });
  });

  // Accordéons (ouverts/fermés)
  function toggleAnswer(id, el){
    const ans = document.getElementById(id);
    const isOpen = ans.classList.contains('answer-visible');
    document.querySelectorAll('.answer').forEach(a=>a.classList.remove('answer-visible'));
    document.querySelectorAll('.question').forEach(q=>q.classList.remove('answer-visible'));
    if(!isOpen){ ans.classList.add('answer-visible'); el.classList.add('answer-visible'); }
  }
</script>
</body>
</html>